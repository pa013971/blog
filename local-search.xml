<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Nginx 常用配置</title>
    <link href="/blog/2022/05/06/Nginx%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE/"/>
    <url>/blog/2022/05/06/Nginx%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="Nginx-常用配置"><a href="#Nginx-常用配置" class="headerlink" title="Nginx 常用配置"></a>Nginx 常用配置</h1><h3 id="下載站點"><a href="#下載站點" class="headerlink" title="下載站點"></a>下載站點</h3><figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">location</span> /download {    <br>    <span class="hljs-attribute">alias</span> /home/user/elivolution; <span class="hljs-comment"># 資料夾路徑</span><br>    <span class="hljs-attribute">autoindex</span> <span class="hljs-literal">on</span>;<br>    <span class="hljs-attribute">charset</span> utf-<span class="hljs-number">8</span>;<br>}<br></code></pre></td></tr></tbody></table></figure><ul><li>alias 資料夾路徑</li><li>autoindex 開啟目錄瀏覽</li><li>charset 防止中文亂碼需加入 utf-8 or gbk</li></ul><h3 id="反向代理並啟用-CORS"><a href="#反向代理並啟用-CORS" class="headerlink" title="反向代理並啟用 CORS"></a>反向代理並啟用 CORS</h3><figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> {<br>    <span class="hljs-comment">#以上審略</span><br><br>    <span class="hljs-attribute">location</span> <span class="hljs-regexp">~ ^/(computer/|mobile|home)</span> {<br>        <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Access-Control-Allow-Origin'</span> *網域 server_name*;<br>        <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Access-Control-Allow-Credentials'</span> <span class="hljs-string">'true'</span>;<br>        <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Access-Control-Allow-Headers'</span> <span class="hljs-string">'Authorization,Accept,Origin,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Content-Range,Range'</span>;<br>        <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Access-Control-Allow-Methods'</span> <span class="hljs-string">'GET,POST,OPTIONS,PUT,DELETE,PATCH'</span>;<br>    <br>        <span class="hljs-attribute">if</span> ($request_method = <span class="hljs-string">'OPTIONS'</span>) {<br>            <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Access-Control-Max-Age'</span> <span class="hljs-number">1728000</span>;<br>            <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Content-Type'</span> <span class="hljs-string">'text/plain charset=UTF-8'</span>;<br>            <span class="hljs-attribute">add_header</span> <span class="hljs-string">'Content-Length'</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-attribute">return</span> <span class="hljs-number">204</span>;<br>        }<br>    <br>        <span class="hljs-attribute">proxy_redirect</span> <span class="hljs-literal">off</span>;<br>        <span class="hljs-attribute">proxy_set_header</span> host $host;<br>        <span class="hljs-attribute">proxy_set_header</span> X-real-ip $remote_addr;<br>        <span class="hljs-attribute">proxy_set_header</span> X-forward-for $proxy_add_x_forwarded_for;<br>        <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:3000;<br>  }<br>}<br></code></pre></td></tr></tbody></table></figure><ul><li>location ~ ^/(computer/|mobile|home)<br>當網址為 <a href="http://domain/computer/name">http://domain/computer/name</a> 或 <a href="http://domain/mobile">http://domain/mobile</a> 時進行轉址</li><li>proxy_pass 填入位置</li></ul><h3 id="http-轉-https"><a href="#http-轉-https" class="headerlink" title="http 轉 https"></a>http 轉 https</h3><figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> {<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> server_name;<br>    <span class="hljs-attribute">return</span> <span class="hljs-number">301</span> https://$host$request_uri;<br>}<br></code></pre></td></tr></tbody></table></figure><h3 id="Vue-router"><a href="#Vue-router" class="headerlink" title="Vue-router"></a>Vue-router</h3><figure class="highlight nginx"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> {<br>    <span class="hljs-comment">#以上審略</span><br><br>    <span class="hljs-attribute">location</span> / {<br>        <span class="hljs-attribute">root</span>   /home/deploy/project_name/dist;<br>        <span class="hljs-attribute">try_files</span> $uri $uri/ /index.html;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure><h3 id="防止機器人"><a href="#防止機器人" class="headerlink" title="防止機器人"></a>防止機器人</h3><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript">server {<br>    #以上審略<br><br>    <span class="hljs-keyword">if</span> ($http_user_agent ~* <span class="hljs-string">"SemrushBot|PetalBot|BOT/0.1|YandexBot|Linguee Bot"</span> ) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">403</span>;             <br>    }<br>}<br></code></pre></td></tr></tbody></table></figure><h3 id="Thank-you-smile"><a href="#Thank-you-smile" class="headerlink" title="Thank you! :smile:"></a>Thank you! <span class="github-emoji"><span>😄</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></h3><hr><p>參考</p><ul><li><a href="https://iter01.com/515464.html">Nginx 配置下載站點</a></li><li><a href="https://stackoverflow.com/questions/45986631/how-to-enable-cors-in-nginx-proxy-server">How to enable CORS in Nginx proxy server?</a></li><li><a href="https://router.vuejs.org/guide/essentials/history-mode.html#nginx">Vue Router</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IIS 架設 VUE 站台</title>
    <link href="/blog/2022/05/05/IIS%E6%9E%B6%E8%A8%ADVUE%E7%AB%99%E5%8F%B0/"/>
    <url>/blog/2022/05/05/IIS%E6%9E%B6%E8%A8%ADVUE%E7%AB%99%E5%8F%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="IIS-架設-vue-站台"><a href="#IIS-架設-vue-站台" class="headerlink" title="IIS 架設 vue 站台"></a>IIS 架設 vue 站台</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>待補!</p><hr><h2 id="準備"><a href="#準備" class="headerlink" title="準備"></a>準備</h2><p>IIS</p><p>URL Rewrite<br>下載網址：<a href="https://www.iis.net/downloads/microsoft/url-rewrite">https://www.iis.net/downloads/microsoft/url-rewrite</a></p><p><em>安裝完畢後在進行下一步</em></p><hr><h2 id="開始"><a href="#開始" class="headerlink" title="開始"></a>開始</h2><h3 id="第一步-建立web-config"><a href="#第一步-建立web-config" class="headerlink" title="第一步 建立web.config"></a>第一步 建立web.config</h3><p>為了讓 IIS 能夠配置 vue-router<br>我們需要一份 web.config</p><p>官方範例 <a href="https://router.vuejs.org/guide/essentials/history-mode.html#internet-information-services-iis">Vue Router</a></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">system.webServer</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">rewrite</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">rules</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Handle History Mode and custom 404/500"</span> <span class="hljs-attr">stopProcessing</span>=<span class="hljs-string">"true"</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">match</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"(.*)"</span> /&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">conditions</span> <span class="hljs-attr">logicalGrouping</span>=<span class="hljs-string">"MatchAll"</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">input</span>=<span class="hljs-string">"{REQUEST_FILENAME}"</span> <span class="hljs-attr">matchType</span>=<span class="hljs-string">"IsFile"</span> <span class="hljs-attr">negate</span>=<span class="hljs-string">"true"</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">input</span>=<span class="hljs-string">"{REQUEST_FILENAME}"</span> <span class="hljs-attr">matchType</span>=<span class="hljs-string">"IsDirectory"</span> <span class="hljs-attr">negate</span>=<span class="hljs-string">"true"</span> /&gt;</span><br>          <span class="hljs-tag">&lt;/<span class="hljs-name">conditions</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"Rewrite"</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"/"</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">rule</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">rules</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">rewrite</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">system.webServer</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure><p>並將此檔案儲存至 vue.js 專案的 public 底下<br>這樣一來，每次建置的時候就會自動將 web.config 產生至 dist 資料夾</p><p><img src="/blog/2022/05/05/IIS%E6%9E%B6%E8%A8%ADVUE%E7%AB%99%E5%8F%B0/1651734577669_1.jpg" alt="web.config 存至 public 底下"></p><h3 id="第二步-建置專案"><a href="#第二步-建置專案" class="headerlink" title="第二步 建置專案"></a>第二步 建置專案</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs npm">npm run build<br></code></pre></td></tr></tbody></table></figure><p><img src="/blog/2022/05/05/IIS%E6%9E%B6%E8%A8%ADVUE%E7%AB%99%E5%8F%B0/1651734577669_2.jpg" alt="建置完成範例圖"></p><h3 id="第三步-設定-IIS"><a href="#第三步-設定-IIS" class="headerlink" title="第三步 設定 IIS"></a>第三步 設定 IIS</h3><p><img src="/blog/2022/05/05/IIS%E6%9E%B6%E8%A8%ADVUE%E7%AB%99%E5%8F%B0/1651734577669_3.jpg" alt="新增網站"></p><p>實體路徑需指定到佈署產生的 dist 資</p><p>如果沒有domain主機名稱可為空</p><p>設定完成後，即可測試 vue 站台是否架設成功</p><h3 id="Thank-you-smile"><a href="#Thank-you-smile" class="headerlink" title="Thank you! :smile:"></a>Thank you! <span class="github-emoji"><span>😄</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></h3><hr><p>參考</p><ul><li><a href="https://router.vuejs.org/guide/essentials/history-mode.html">Vue Router</a></li><li><a href="https://www.linkedin.com/pulse/hosting-vue-js-spa-build-microsoft-iis-zainul-zain">Hosting Vue JS SPA build on Microsoft IIS</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IIS</tag>
      
      <tag>URL Rewrite</tag>
      
      <tag>Vue Router</tag>
      
      <tag>web.config</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IIS 實現反向代理</title>
    <link href="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
    <url>/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="IIS-實現反向代理"><a href="#IIS-實現反向代理" class="headerlink" title="IIS 實現反向代理"></a>IIS 實現反向代理</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>反向代理（Reverse Proxy）方式是指以代理伺服器來接受internet上的連接請求，然後將請求轉發給內部網絡上的伺服器，並將從伺服器上得到的結果返回給internet上請求連接的客戶端，此時代理伺服器對外就表現為一個反向代理伺服器。</p><hr><h2 id="準備"><a href="#準備" class="headerlink" title="準備"></a>準備</h2><p>IIS</p><p>Application Request Routing<br>下載網址：<a href="https://www.iis.net/downloads/microsoft/application-request-routing">https://www.iis.net/downloads/microsoft/application-request-routing</a></p><p>URL Rewrite<br>下載網址：<a href="https://www.iis.net/downloads/microsoft/url-rewrite">https://www.iis.net/downloads/microsoft/url-rewrite</a></p><hr><h2 id="開始"><a href="#開始" class="headerlink" title="開始"></a>開始</h2><p>當下載並安裝完成後 IIS 會多出兩個功能<br><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651667908894_new.jpg" alt="準備完成樣子"></p><p>第一步、啟動代理<br><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651667908894_1.jpg" alt="點擊設置"></p><p><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651668036918_2.jpg" alt="點擊反向代理設定"></p><p><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651668062343_3.jpg" alt="將反向代理開啟"></p><p>第二步、新增反向代理，設置 URL 規則</p><p><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651668152705_1.jpg" alt="點擊站台設定URL Rewrite"></p><p><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651668152705_2.jpg" alt="新增規則 / 空白規則"></p><p><img src="/blog/2022/05/04/IIS%E5%AF%A6%E7%8F%BE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/1651668152705_3.jpg" alt="設定並套用"></p><p>設置完畢即完成</p>]]></content>
    
    
    <categories>
      
      <category>DevOps</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Reverse Proxy</tag>
      
      <tag>IIS</tag>
      
      <tag>URL Rewrite</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
